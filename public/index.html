<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geotrends - Analytics Dashboard | Camilo</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.0.2/wordcloud2.min.js"></script>
</head>
<body>
    <!-- Animación de fondo Luma AI -->
    <div class="background-animation">
        <iframe 
            src="https://lumalabs.ai/embed/e36f0cf1-66b8-4613-8bd0-0f0c545b36bd?mode=sparkles&background=%23ffffff&color=%23000000&showTitle=true&loadBg=true&logoPosition=bottom-left&infoPosition=bottom-right&cinematicVideo=undefined&showMenu=false"
            frameborder="0"
            allowfullscreen>
        </iframe>
    </div>

    <!-- Contenedor principal -->
    <div class="dashboard-container">
        <!-- Barra de navegación superior -->
        <nav class="top-nav">
            <div class="nav-left">
                <h2 class="logo">Geotrends</h2>
                <div class="nav-links">
                    <a href="#" class="nav-link active">camideambiente</a>
                    <a href="#" class="nav-link">Analytics</a>
                    <a href="#" class="nav-link">Reportes</a>
                </div>
            </div>
            <div class="nav-center">
                <div class="search-bar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="text" placeholder="Buscar...">
                </div>
            </div>
            <div class="nav-right">
                <button class="icon-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                    </svg>
                </button>
                <button class="icon-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                </button>
                <div class="user-profile">
                    <div class="avatar">C</div>
                    <div class="user-info">
                        <span class="user-name">Camilo</span>
                        <span class="user-role">Político</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Contenido principal -->
        <main class="main-content">
            <div class="content-header">
                <h1>Dashboard de Instagram</h1>
                <div class="header-buttons">
                    <button class="btn active" data-tab="followers">followers</button>
                    <button class="btn" data-tab="profiles">profiles</button>
                    <button class="btn" data-tab="posts">posts</button>
                    <button class="btn" data-tab="images">images</button>
                </div>
            </div>

            <!-- Vista followers (por defecto) -->
            <div class="dashboard-view" data-view="followers">
            <!-- Perfil Camilo + Tarjetas de métricas lado a lado -->
            <div class="metrics-and-profile-row">
                <!-- Información del Perfil Camilo (izquierda) -->
                <div class="profile-card glass">
                    <div class="profile-header">
                        <div class="profile-avatar-large">C</div>
                        <div class="profile-info">
                            <h3>Camilo</h3>
                            <div class="profile-rating">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                </svg>
                                <span>4.8 (2.5K reviews)</span>
                            </div>
                        </div>
                    </div>
                    <div class="profile-details">
                        <div class="detail-item">
                            <span class="detail-label">Instagram</span>
                            <span class="detail-value">@camilo</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Categoría</span>
                            <span class="detail-value">Político</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Última actualización</span>
                            <span class="detail-value">Hace 2 horas</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Total Engagement</span>
                            <span class="detail-value highlight">+18.5%</span>
                        </div>
                    </div>
                </div>
                <div class="metrics-grid">
                <div class="metric-card glass" data-card-id="card-seguidores">
                    <div class="metric-header">
                        <span class="metric-label">Total Seguidores</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <div class="metric-value" id="metric-seguidores">__COUNT_SEGUIDORES__</div>
                </div>

                <div class="metric-card glass" data-card-id="card-perfiles-analizados">
                    <div class="metric-header">
                        <span class="metric-label">PROFILES ANALYZED</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <div class="metric-value">—</div>
                </div>

                <div class="metric-card glass" data-card-id="card-posts-analizados">
                    <div class="metric-header">
                        <span class="metric-label">POSTS ANALYZED</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="9" y1="21" x2="9" y2="9"></line>
                        </svg>
                    </div>
                    <div class="metric-value">—</div>
                </div>

                <div class="metric-card glass" data-card-id="card-comments-analizados">
                    <div class="metric-header">
                        <span class="metric-label">COMMENTS ANALYZED</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                    </div>
                    <div class="metric-value">—</div>
                </div>
                </div>
            </div>

            <!-- Fila de gráficas principales -->
            <div class="charts-row">
                <!-- Gráfica bubble - Distribución perfiles -->
                <div class="chart-card glass">
                    <div class="chart-header">
                        <h3>Distribución: Seguidores vs Seguidos (tamaño = posts)</h3>
                        <button class="chart-menu">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="19" cy="12" r="1"></circle>
                                <circle cx="5" cy="12" r="1"></circle>
                            </svg>
                        </button>
                    </div>
                    <div class="chart-canvas-wrap" id="chartDistribucionWrap">
                        <div id="chartDistribucionPerfiles"></div>
                    </div>
                </div>

                <!-- Filtros adicionales + Gráfica filtrada -->
                <div class="chart-card glass" style="grid-column: 1 / -1;">
                    <div class="chart-header chart-header-with-filters">
                        <div class="chart-header-left">
                            <h3>Filtrado: >500 seguidos, 500-5000 seguidores (tamaño = posts)</h3>
                            <div class="chart-stats-cards" id="chartFiltradoStatsCards">
                                <div class="chart-stat-card"><span class="chart-stat-label">Base</span><span class="chart-stat-value" id="statBase">—</span></div>
                                <div class="chart-stat-card"><span class="chart-stat-label">Privadas</span><span class="chart-stat-value" id="statPrivadas">—</span></div>
                                <div class="chart-stat-card"><span class="chart-stat-label">Públicas</span><span class="chart-stat-value" id="statPublicas">—</span></div>
                                <div class="chart-stat-card"><span class="chart-stat-label">Personal</span><span class="chart-stat-value" id="statPersonal">—</span></div>
                                <div class="chart-stat-card"><span class="chart-stat-label">Business</span><span class="chart-stat-value" id="statBusiness">—</span></div>
                                <div class="chart-stat-card"><span class="chart-stat-label">Verificadas</span><span class="chart-stat-value" id="statVerificadas">—</span></div>
                            </div>
                            <div class="chart-filters-row">
                            <div class="chart-filter-item">
                                <label for="filterPrivate">Privada/Pública</label>
                                <select id="filterPrivate">
                                    <option value="">Todas</option>
                                    <option value="true">Privada</option>
                                    <option value="false">Pública</option>
                                </select>
                            </div>
                            <div class="chart-filter-item">
                                <label for="filterBusiness">Tipo cuenta</label>
                                <select id="filterBusiness">
                                    <option value="">Todas</option>
                                    <option value="false">Personal</option>
                                    <option value="true">Business</option>
                                </select>
                            </div>
                            <div class="chart-filter-item">
                                <label for="filterVerified">Verificada</label>
                                <select id="filterVerified">
                                    <option value="">Todas</option>
                                    <option value="true">Sí</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                            </div>
                        </div>
                        <button class="chart-menu">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="19" cy="12" r="1"></circle>
                                <circle cx="5" cy="12" r="1"></circle>
                            </svg>
                        </button>
                    </div>
                    <div class="chart-canvas-wrap">
                        <div id="chartDistribucionPerfilesFiltrado"></div>
                    </div>
                    <div class="chart-filter-stats" id="chartFiltradoStats"></div>
                </div>

                <!-- Word cloud - biografías de perfiles -->
                <div class="chart-card glass" style="grid-column: 1 / -1; margin-top: 2rem;">
                    <div class="chart-header">
                        <div>
                            <h3>Word cloud - Biografías</h3>
                            <p class="chart-subtitle" id="wordcloudSubtitle">Palabras extraídas de las biografías de perfiles con 500-5000 seguidores</p>
                        </div>
                        <div class="wordcloud-controls" style="display:flex;flex-wrap:wrap;align-items:center;gap:1rem;">
                            <div class="wordcloud-mode-btns" style="display:flex;gap:0.5rem;">
                                <button type="button" class="btn btn-wordcloud-mode" id="wordcloudModeTotal" data-mode="total">Total</button>
                                <button type="button" class="btn btn-wordcloud-mode active" id="wordcloudModeSesgo" data-mode="sesgo">Sesgo</button>
                            </div>
                            <div style="display:flex;align-items:center;gap:0.5rem;">
                                <label style="color:rgba(255,255,255,0.8);font-size:0.9rem;">Frecuencia mínima:</label>
                                <input type="range" id="wordcloudMinFreq" min="2" max="10" value="2">
                                <span id="wordcloudMinFreqVal" style="color:rgba(255,255,255,0.9);">2</span>
                            </div>
                        </div>
                    </div>
                    <div class="wordcloud-wrap" id="wordcloudBiografias">
                        <!-- Se renderiza el canvas aquí -->
                    </div>
                    <div class="chart-filter-stats" id="wordcloudBiografiasStats"></div>
                </div>

            </div>

            <!-- Top profiles - debajo de las 2 gráficas -->
            <div class="top-profiles-section glass">
                <h3 class="top-profiles-title">Top profiles</h3>
                <p class="top-profiles-subtitle">Top 6 perfiles con más seguidores en el rango (500-5000 seguidores, >500 seguidos):</p>
                <div class="top-profiles-grid" id="topProfilesGrid">
                    <!-- Se cargan dinámicamente -->
                </div>
                <p class="top-profiles-desc">Perfiles con mayor alcance potencial en la campaña. Los conteos de seguidores y seguidos ayudan a entender la influencia y conectividad de cada perfil en la red.</p>
            </div>

            </div><!-- /followers -->

            <!-- Vista profiles: posts + usuarios que comentaron -->
            <div class="dashboard-view" data-view="profiles" style="display:none;">
                <!-- Posts con más comentarios - arriba -->
                <div class="charts-row" style="margin-bottom: 2rem;">
                    <div class="list-card glass" style="width: 100%;">
                        <div class="list-header">
                            <h3>Posts con más comentarios</h3>
                            <span class="post-count-badge">23 posts</span>
                        </div>
                        <div class="posts-list" id="postsList">
                            <!-- Los posts se cargan dinámicamente -->
                        </div>
                    </div>
                </div>
                <div class="charts-row">
                    <div class="chart-card glass" style="grid-column: 1 / -1;">
                        <div class="chart-header">
                            <div>
                                <h3>Usuarios que comentaron en posts virales</h3>
                                <p class="chart-subtitle">Seguidores vs seguidos (tamaño = posts). Primeros 100 comentarios por post más comentado.</p>
                            </div>
                            <button class="chart-menu">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="1"></circle>
                                    <circle cx="19" cy="12" r="1"></circle>
                                    <circle cx="5" cy="12" r="1"></circle>
                                </svg>
                            </button>
                        </div>
                        <div class="chart-canvas-wrap">
                            <div id="chartDistribucionUsuariosComentarios"></div>
                        </div>
                    </div>
                </div>
                <!-- Gráfica filtrada: solo 200-4000 seguidores (usuarios comentarios) -->
                <div class="charts-row">
                    <div class="chart-card glass" style="grid-column: 1 / -1;">
                        <div class="chart-header chart-header-with-filters">
                            <div class="chart-header-left">
                                <h3>Distribución filtrada: 200-4000 seguidores (usuarios que comentaron)</h3>
                                <p class="chart-subtitle">Usuarios que comentaron en posts virales. Tamaño = posts.</p>
                                <div class="chart-stats-cards" id="chartUsuariosComentariosStatsCards">
                                    <div class="chart-stat-card"><span class="chart-stat-label">Base</span><span class="chart-stat-value" id="statBaseProfiles">—</span></div>
                                    <div class="chart-stat-card"><span class="chart-stat-label">Privadas</span><span class="chart-stat-value" id="statPrivadasProfiles">—</span></div>
                                    <div class="chart-stat-card"><span class="chart-stat-label">Públicas</span><span class="chart-stat-value" id="statPublicasProfiles">—</span></div>
                                    <div class="chart-stat-card"><span class="chart-stat-label">Personal</span><span class="chart-stat-value" id="statPersonalProfiles">—</span></div>
                                    <div class="chart-stat-card"><span class="chart-stat-label">Business</span><span class="chart-stat-value" id="statBusinessProfiles">—</span></div>
                                    <div class="chart-stat-card"><span class="chart-stat-label">Verificadas</span><span class="chart-stat-value" id="statVerificadasProfiles">—</span></div>
                                </div>
                                <div class="chart-filters-row">
                                    <div class="chart-filter-item">
                                        <label for="filterPrivateProfiles">Privada/Pública</label>
                                        <select id="filterPrivateProfiles">
                                            <option value="">Todas</option>
                                            <option value="true">Privada</option>
                                            <option value="false">Pública</option>
                                        </select>
                                    </div>
                                    <div class="chart-filter-item">
                                        <label for="filterBusinessProfiles">Tipo cuenta</label>
                                        <select id="filterBusinessProfiles">
                                            <option value="">Todas</option>
                                            <option value="false">Personal</option>
                                            <option value="true">Business</option>
                                        </select>
                                    </div>
                                    <div class="chart-filter-item">
                                        <label for="filterVerifiedProfiles">Verificada</label>
                                        <select id="filterVerifiedProfiles">
                                            <option value="">Todas</option>
                                            <option value="true">Sí</option>
                                            <option value="false">No</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <button class="chart-menu">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="1"></circle>
                                    <circle cx="19" cy="12" r="1"></circle>
                                    <circle cx="5" cy="12" r="1"></circle>
                                </svg>
                            </button>
                        </div>
                        <div class="chart-canvas-wrap">
                            <div id="chartDistribucionUsuariosComentariosFiltrado"></div>
                        </div>
                        <div class="chart-filter-stats" id="chartUsuariosComentariosFiltradoStats"></div>
                    </div>
                </div>

                <!-- Word cloud - biografías usuarios que comentaron -->
                <div class="chart-card glass" style="grid-column: 1 / -1; margin-top: 2rem;">
                    <div class="chart-header">
                        <div>
                            <h3>Word cloud - Biografías (usuarios que comentaron)</h3>
                            <p class="chart-subtitle" id="wordcloudSubtitleComentarios">Palabras extraídas de las biografías de perfiles con 200-4000 seguidores</p>
                        </div>
                        <div class="wordcloud-controls" style="display:flex;flex-wrap:wrap;align-items:center;gap:1rem;">
                            <div class="wordcloud-mode-btns" style="display:flex;gap:0.5rem;">
                                <button type="button" class="btn btn-wordcloud-mode" id="wordcloudModeTotalComentarios" data-mode="total">Total</button>
                                <button type="button" class="btn btn-wordcloud-mode active" id="wordcloudModeSesgoComentarios" data-mode="sesgo">Sesgo</button>
                            </div>
                            <div style="display:flex;align-items:center;gap:0.5rem;">
                                <label style="color:rgba(255,255,255,0.8);font-size:0.9rem;">Frecuencia mínima:</label>
                                <input type="range" id="wordcloudMinFreqComentarios" min="2" max="10" value="2">
                                <span id="wordcloudMinFreqValComentarios" style="color:rgba(255,255,255,0.9);">2</span>
                            </div>
                        </div>
                    </div>
                    <div class="wordcloud-wrap" id="wordcloudBiografiasComentarios">
                        <!-- Se renderiza el canvas aquí -->
                    </div>
                    <div class="chart-filter-stats" id="wordcloudBiografiasComentariosStats"></div>
                </div>
            </div><!-- /profiles -->

        </main>
    </div>

    <!-- Iconos flotantes -->
    <div class="floating-icons">
        <button class="floating-icon" title="Pantalla completa">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
            </svg>
        </button>
        <button class="floating-icon" title="Buscar">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        </button>
    </div>

    <script>window.__POSTS_MAS_COMENTADOS__ = __POSTS_JSON__;</script>
    <script src="/graficas/cards/seguidores.js"></script>
    <script src="/graficas/cards/perfilesAnalizados.js"></script>
    <script src="/graficas/cards/postsAnalizados.js"></script>
    <script src="/graficas/cards/commentsAnalizados.js"></script>
    <script src="/graficas/cards/topPerfilesPotenciales.js"></script>
    <script src="/graficas/cards/postsMasComentados.js"></script>
    <script src="/graficas/charts/distribucionPerfiles.js"></script>
    <script src="/graficas/charts/distribucionPerfilesFiltrado.js"></script>
    <script src="/graficas/charts/wordcloudBiografias.js"></script>
    <script src="/graficas/charts/distribucionUsuariosComentarios.js"></script>
    <script src="/graficas/charts/distribucionUsuariosComentariosFiltrado.js"></script>
    <script src="/graficas/charts/wordcloudBiografiasComentarios.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
